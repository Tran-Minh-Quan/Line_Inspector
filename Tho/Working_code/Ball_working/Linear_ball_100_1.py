from scipy import stats
import numpy as np
import pandas as pd
my_y = np.arange(20, 100.1, 1)
my_x = np.array([0.003711952487008, 0.003824091778203, 0.003980891719745, 0.004132231404959, 0.004253509145045,
                 0.004587155963303, 0.004675081813932, 0.004970178926441, 0.00470145745181, 0.005241090146751,
                 0.005086469989827, 0.005344735435596, 0.00551876379691, 0.005656108597285, 0.005727376861397,
                 0.005941770647653, 0.006060606060606, 0.006161429451633, 0.006333122229259, 0.00640204865557,
                 0.00668449197861, 0.006910850034554, 0.006854009595613, 0.006910850034554, 0.007153075822604,
                 0.007147962830593, 0.007293946024799, 0.007473841554559, 0.007501875468867, 0.007716049382716,
                 0.00776397515528, 0.008, 0.00815660685155, 0.008361204013378, 0.008354218880535, 0.00886524822695,
                 0.008554319931565, 0.008802816901408, 0.009025270758123, 0.009041591320072, 0.009496676163343,
                 0.009242144177449, 0.009643201542912, 0.00965250965251, 0.009633911368015, 0.009832841691249,
                 0.009920634920635, 0.01004016064257, 0.010111223458039, 0.010493179433368, 0.010741138560688,
                 0.010582010582011, 0.011013215859031, 0.010989010989011, 0.011248593925759, 0.011363636363636,
                 0.01194743130227, 0.011299435028249, 0.011976047904192, 0.011402508551882, 0.012150668286756,
                 0.01219512195122, 0.012531328320802, 0.012674271229404, 0.01194743130227, 0.012391573729864,
                 0.013333333333333, 0.013003901170351, 0.012886597938144, 0.013297872340426, 0.013140604467806,
                 0.012836970474968, 0.013440860215054, 0.014164305949009, 0.01338688085676, 0.013440860215054,
                 0.013812154696133, 0.014005602240896, 0.013736263736264, 0.013605442176871, 0.014367816091954
                 ])
slope, intercept, r_value, p_value, std_err = stats.linregress(my_x, my_y)
prediction = my_x * slope + intercept
error = prediction - my_y
mean_abs_err = sum(abs(my_y - prediction))/len(my_y)
std_deviation_err = np.sqrt(sum(abs(my_y - prediction)**2)/len(my_y))

df_prediction = pd.DataFrame(prediction)
df_error = pd.DataFrame(error)
df_prediction.to_excel('/media/tho/D drive/Documents/ball_prediction.xlsx', index=False)
df_error.to_excel('/media/tho/D drive/Documents/ball_error.xlsx', index=False)

print("Slope is: {}".format(slope))
print("Intercept is: {}".format(intercept))
print("Mean absolute error is: {}".format(mean_abs_err))
print("Standard deviation error is: {}".format(std_deviation_err))
print("Maximum error on set: {}".format(abs(my_y - prediction).max()))

